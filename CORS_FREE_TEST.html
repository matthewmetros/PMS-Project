<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PMS Inspector - CORS-Free Test</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f9fafb; }
        .container { max-width: 1200px; margin: 0 auto; padding: 2rem; }
        .header { background: white; border-radius: 0.5rem; padding: 2rem; margin-bottom: 2rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .title { font-size: 2rem; font-weight: 700; color: #111827; margin-bottom: 0.5rem; }
        .subtitle { color: #6b7280; margin-bottom: 2rem; }
        .info-box { background: #eff6ff; border: 1px solid #3b82f6; border-radius: 0.5rem; padding: 1rem; margin-bottom: 2rem; }
        .info-title { font-weight: 600; color: #1d4ed8; margin-bottom: 0.5rem; }
        .info-text { color: #1e40af; font-size: 0.875rem; }
        .error-box { background: #fef2f2; border: 1px solid #f87171; border-radius: 0.5rem; padding: 1rem; margin-bottom: 2rem; }
        .error-title { font-weight: 600; color: #dc2626; margin-bottom: 0.5rem; }
        .error-text { color: #dc2626; font-size: 0.875rem; }
        .solution-box { background: #f0fdf4; border: 1px solid #22c55e; border-radius: 0.5rem; padding: 1rem; margin-bottom: 2rem; }
        .solution-title { font-weight: 600; color: #16a34a; margin-bottom: 0.5rem; }
        .solution-text { color: #15803d; font-size: 0.875rem; }
        .form-section { background: white; border-radius: 0.5rem; padding: 2rem; margin-bottom: 2rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .form-title { font-size: 1.25rem; font-weight: 600; color: #111827; margin-bottom: 1rem; }
        .form-group { margin-bottom: 1.5rem; }
        .label { display: block; font-size: 0.875rem; font-weight: 500; color: #374151; margin-bottom: 0.5rem; }
        .input { width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem; font-size: 0.875rem; }
        .textarea { width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem; font-size: 0.875rem; font-family: 'SF Mono', Monaco, monospace; min-height: 6rem; }
        .btn { padding: 0.75rem 1.5rem; border: none; border-radius: 0.375rem; font-size: 0.875rem; font-weight: 500; cursor: pointer; transition: all 0.2s; margin-right: 1rem; }
        .btn-primary { background: #2563eb; color: white; }
        .btn-primary:hover { background: #1d4ed8; }
        .btn-success { background: #16a34a; color: white; }
        .btn-success:hover { background: #15803d; }
        .code-block { background: #1f2937; color: #f9fafb; padding: 1rem; border-radius: 0.375rem; font-family: 'SF Mono', Monaco, monospace; font-size: 0.875rem; overflow-x: auto; margin: 1rem 0; }
        .step { background: white; border-radius: 0.5rem; padding: 1.5rem; margin-bottom: 1rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .step-number { background: #2563eb; color: white; width: 2rem; height: 2rem; border-radius: 50%; display: inline-flex; align-items: center; justify-content: center; font-weight: 600; margin-right: 1rem; }
        .step-title { font-size: 1.125rem; font-weight: 600; color: #111827; margin-bottom: 0.5rem; display: flex; align-items: center; }
        .step-text { color: #6b7280; }
        .copy-btn { background: #f3f4f6; border: 1px solid #d1d5db; color: #374151; padding: 0.25rem 0.5rem; border-radius: 0.25rem; font-size: 0.75rem; cursor: pointer; margin-left: 0.5rem; }
        .copy-btn:hover { background: #e5e7eb; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">PMS Inspector - CORS Solution</h1>
            <p class="subtitle">Let's fix the CORS issue and get your API testing working</p>
        </div>

        <div class="error-box">
            <div class="error-title">üö´ Common CORS Error</div>
            <div class="error-text">
                You likely saw an error like: "Access to fetch at 'https://api.hospitable.com/...' from origin 'file://' has been blocked by CORS policy"
                <br><br>
                This happens because browsers block API calls from local HTML files for security reasons.
            </div>
        </div>

        <div class="solution-box">
            <div class="solution-title">‚úÖ Solution Options</div>
            <div class="solution-text">
                Choose one of these methods to test your API properly:
            </div>
        </div>

        <div class="step">
            <div class="step-title">
                <span class="step-number">1</span>
                Easy: Use a Local Server (Recommended)
            </div>
            <div class="step-text">
                <p>Run a simple local server to avoid CORS issues:</p>
                <div class="code-block">
# Option A: If you have Python installed
python3 -m http.server 8080

# Option B: If you have Node.js installed  
npx serve .

# Option C: If you have PHP installed
php -S localhost:8080</div>
                <p>Then open: <strong>http://localhost:8080/PRODUCTION_TEST.html</strong></p>
                <button class="copy-btn" onclick="copyToClipboard('python3 -m http.server 8080')">Copy Python Command</button>
                <button class="copy-btn" onclick="copyToClipboard('npx serve .')">Copy Node Command</button>
            </div>
        </div>

        <div class="step">
            <div class="step-title">
                <span class="step-number">2</span>
                Chrome: Disable CORS Temporarily
            </div>
            <div class="step-text">
                <p><strong>‚ö†Ô∏è Only for testing - don't browse the web with this!</strong></p>
                <ol style="margin-left: 2rem; margin-top: 0.5rem;">
                    <li>Close all Chrome windows completely</li>
                    <li>Open Terminal/Command Prompt</li>
                    <li>Run this command:</li>
                </ol>
                <div class="code-block">
# Mac:
open -n -a /Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome --args --user-data-dir="/tmp/chrome_dev_test" --disable-web-security

# Windows:
"C:\Program Files\Google\Chrome\Application\chrome.exe" --user-data-dir="c:/chrome_dev_test" --disable-web-security

# Linux:
google-chrome --user-data-dir="/tmp/chrome_dev_test" --disable-web-security</div>
                <button class="copy-btn" onclick="copyToClipboard('open -n -a /Applications/Google\\ Chrome.app/Contents/MacOS/Google\\ Chrome --args --user-data-dir=\"/tmp/chrome_dev_test\" --disable-web-security')">Copy Mac Command</button>
            </div>
        </div>

        <div class="step">
            <div class="step-title">
                <span class="step-number">3</span>
                Use a CORS Proxy (Quick Test)
            </div>
            <div class="step-text">
                <p>Test with a CORS proxy service (for testing only):</p>
                <div class="form-group">
                    <label class="label">API Token</label>
                    <input type="password" class="input" id="proxyToken" placeholder="Enter your Hospitable API token..." />
                </div>
                <div class="form-group">
                    <label class="label">Test Endpoint</label>
                    <textarea class="textarea" id="proxyEndpoint">https://api.hospitable.com/v1/properties?limit=5</textarea>
                </div>
                <button class="btn btn-primary" onclick="testWithProxy()">Test with CORS Proxy</button>
                <div id="proxyResults" style="margin-top: 1rem;"></div>
            </div>
        </div>

        <div class="step">
            <div class="step-title">
                <span class="step-number">4</span>
                Production Solution: Deploy to a Web Server
            </div>
            <div class="step-text">
                <p>For production use, deploy your app to:</p>
                <ul style="margin-left: 2rem; margin-top: 0.5rem;">
                    <li><strong>Vercel</strong> - Free hosting with custom domains</li>
                    <li><strong>Netlify</strong> - Easy drag-and-drop deployment</li>
                    <li><strong>GitHub Pages</strong> - Free hosting from your repository</li>
                    <li><strong>Your own server</strong> - Full control</li>
                </ul>
                <button class="btn btn-success" onclick="showDeploymentInstructions()">Show Deployment Instructions</button>
            </div>
        </div>

        <div id="deploymentInstructions" style="display: none;" class="form-section">
            <h2 class="form-title">üöÄ Quick Deployment to Vercel</h2>
            <ol style="margin-left: 2rem;">
                <li>Go to <a href="https://vercel.com" target="_blank">vercel.com</a></li>
                <li>Sign up with GitHub (free)</li>
                <li>Create a new project</li>
                <li>Upload your project folder</li>
                <li>Deploy! You'll get a URL like: https://your-app.vercel.app</li>
            </ol>
            <p style="margin-top: 1rem; color: #6b7280;">No CORS issues, professional URL, and free hosting!</p>
        </div>
    </div>

    <script>
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert('Copied to clipboard!');
            });
        }

        async function testWithProxy() {
            const token = document.getElementById('proxyToken').value;
            const endpoint = document.getElementById('proxyEndpoint').value;
            const resultsDiv = document.getElementById('proxyResults');

            if (!token) {
                alert('Please enter your API token');
                return;
            }

            resultsDiv.innerHTML = '<p>Testing with CORS proxy...</p>';

            try {
                // Using a public CORS proxy (for testing only)
                const proxyUrl = `https://cors-anywhere.herokuapp.com/${endpoint}`;
                
                const response = await fetch(proxyUrl, {
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'X-Requested-With': 'XMLHttpRequest'
                    }
                });

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();
                resultsDiv.innerHTML = `
                    <div style="background: #f0fdf4; border: 1px solid #22c55e; border-radius: 0.5rem; padding: 1rem; margin-top: 1rem;">
                        <strong>‚úÖ Success!</strong><br>
                        Received ${Array.isArray(data) ? data.length : 1} records from the API.
                        <pre style="margin-top: 0.5rem; font-size: 0.75rem; overflow-x: auto;">${JSON.stringify(data, null, 2).substring(0, 500)}...</pre>
                    </div>
                `;
            } catch (error) {
                resultsDiv.innerHTML = `
                    <div style="background: #fef2f2; border: 1px solid #f87171; border-radius: 0.5rem; padding: 1rem; margin-top: 1rem;">
                        <strong>‚ùå Error:</strong> ${error.message}<br>
                        <small>Note: The CORS proxy might require activation at cors-anywhere.herokuapp.com</small>
                    </div>
                `;
            }
        }

        function showDeploymentInstructions() {
            document.getElementById('deploymentInstructions').style.display = 'block';
        }
    </script>
</body>
</html>